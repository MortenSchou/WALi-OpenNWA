# Build the waliparse library
# $Id$

import os,platform

print "\n+++ Building waliparse library."

Debug = True

Import('WaliDir')
Import('LibInstallDir')
Import('MkStatic')
Import('BaseEnv')

if Debug:
    print "+ WaliDir       : '%s'" % WaliDir
    print "+ LibInstallDir : '%s'" % LibInstallDir 

waliparse_files = Split("""
./wali/wpds/ewpds/EWpdsHandler.cpp
./wali/wpds/ewpds/MergeFactory.cpp
./wali/wpds/WpdsHandler.cpp
./wali/wfa/WfaHandler.cpp
./wali/QueryHandler.cpp
./wali/Parser.cpp
./StrX.cpp
""")

env = BaseEnv.Clone()

# Define include directories
IncludeDirs = [
    os.path.join(WaliDir , 'Source'),
    os.path.join(WaliDir,'AddOns','Parse','Source'),
    os.path.join(WaliDir,'AddOns','Parse','ThirdParty','xerces-c','include'),
]

if Debug:
    for i in IncludeDirs:
        print "+ Inlude        : %s" % i

env['CPPPATH'] = IncludeDirs

if MkStatic:
    waliparse = env.StaticLibrary('waliparse' , waliparse_files)
    env.Install(LibInstallDir, waliparse)
else:
    waliparse = env.SharedLibrary('waliparse' , waliparse_files)
    env.Install(LibInstallDir, waliparse)

